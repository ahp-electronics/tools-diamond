<!DOCTYPE html ><html xml:lang="en" lang="en" data-highlight-require-whitespace="false" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta http-equiv="Content-Style-Type" content="text/css" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta http-equiv="X-UA-Compatible" content="IE=edge" /><title>Map Register Retiming</title><link rel="Prev" href="packing_of_duplicate_registers.htm" title="Previous" /><link rel="Next" href="placing_and_routing_a_design.htm" title="Next" /><link rel="StyleSheet" href="../../css/font-awesome/css/font-awesome.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/design_imp_2.css" type="text/css" media="all" /><link rel="StyleSheet" href="../css/webworks.css" type="text/css" media="all" /><link rel="StyleSheet" href="../css/skin.css" type="text/css" media="all" /><link rel="StyleSheet" href="../css/social.css" type="text/css" media="all" /><link rel="StyleSheet" href="../css/print.css" type="text/css" media="print" /><script type="text/javascript" src="../scripts/common.js"></script><script type="text/javascript" src="../scripts/page.js"></script><script type="text/javascript" src="../scripts/search-client.js"></script><script type="text/javascript" src="../scripts/unidata.js"></script><script type="text/javascript" src="../scripts/unibreak.js"></script><noscript><div id="noscript_padding"></div></noscript></head><body id="pt0pC1dReeYBnmcZbdG_002f9IQ" class="ww_skin_page_body" onload="Page.OnLoad('../../index.htm#page/User%20Guides/Implementing%20the%20Design/Map_Register_Re-Timing.htm');"><div id="ww_content_container"><header id="wwconnect_header"><div class="ww_skin_page_toolbar"><a class="ww_behavior_print ww_skin ww_skin_print" title="Print" href="#"><i class="fa"></i></a></div><!-- was this helpful button --><!--                         --><!-- Moved breadcrumbs to bottom of the header so that the print --><!-- button would float to the right of the breadcrumbs. --><!-- PH 4June2019 --><div class="ww_skin_breadcrumbs"><a class="WebWorks_Breadcrumb_Link" href="../Getting%20Startred/Getting_Started.htm">User Guides</a> &gt; <a class="WebWorks_Breadcrumb_Link" href="implementing_the_design.htm#1022012">Implementing the Design </a> &gt; <a class="WebWorks_Breadcrumb_Link" href="mapping_intro.htm#1022012">Mapping</a> &gt; Map Register Retiming</div></header><div id="page_content_container" style="background-color: White; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px"><div id="page_content"><h3 id="ww1022012" class="Heading2"><span></span>Map Register Retiming</h3><p id="ww1022013" class="BodyAfterHead"><span></span>Register retiming is a technique for improving timing. It involves moving registers across logic to shift path delay from one side of a register to the other side. This retiming technique has the same goal as clock boosting (or cycle stealing), which adjusts the timing by introducing predefined clock delays. </p><p id="ww1022015" class="Body"><span></span>The map register retiming property moves registers across combinational logic to balance timing according to the constraints t<span style="vertical-align: sub">SU</span> (INPUT_SETUP), t<span style="vertical-align: sub">CO</span> (CLOCK_TO_OUT) and f<span style="vertical-align: sub">MAX</span> (FREQUENCY). This is a typical logic optimization technique to balance combinational logic across register-pairs to allow you to maximize clock frequency. However, there is no guarantee that a better f<span style="vertical-align: sub">MAX</span> can be achieved. The f<span style="vertical-align: sub">MAX</span> constraint activates retiming around all registers. The t<span style="vertical-align: sub">SU</span> and t<span style="vertical-align: sub">CO</span> constraints may de-activate retiming on I/O registers depending on the balancing of t<span style="vertical-align: sub">SU</span> versus f<span style="vertical-align: sub">MAX</span> and t<span style="vertical-align: sub">CO</span> versus f<span style="vertical-align: sub">MAX</span>. The retiming process stops when it estimates that the constraints have been met. </p><h5 id="ww1022016" class="StepIntro"><span></span>To enable register retiming in your design: </h5><div id="ww1022017" class="Bulleted"><span class="WebWorks_Number" style="width: 16.56pt"><span><img src="../square.png" alt="*" border="0" width="7" height="7" /></span></span>Enable the <span class="GUI">Register Retiming</span> Map option in the <span class="GUI">Strategies</span> dialog box, as explained in <span class="Hyperlink"><a href="../../User%20Guides/Implementing%20the%20Design/mapping_options.htm#ww1071510" title="Setting Map Design Options">Setting Map Design Options</a></span>. This Map option will be available after an initial design run, not before. Values are True and False (default). </div><div id="ww1022020" class="Indented">See <span class="Hyperlink"><a href="../../Reference%20Guides/Strategies/options_map_design.htm#ww1145174" title="Map Design Options">Register Retiming</a></span> for details on option settings and default values. This feature can also be prevented for specific design elements with the NORETIME attribute.</div><div id="ww1051602" class="Bulleted"><span class="WebWorks_Number" style="width: 16.56pt"><span><img src="../square.png" alt="*" border="0" width="7" height="7" /></span></span>For command line usage, review the documentation on the<span class="Hyperlink"><a href="../../Reference%20Guides/Command%20Line/running_map_from_the_command_line_1.htm#ww1177081" title="Running MAP from the Command Line"> -retime</a></span> parameter in the <span style="color: #196bff"><a href="../../Reference%20Guides/Command%20Line/running_map_from_the_command_line_1.htm#ww1167914" title="Running MAP from the Command Line">Running MAP from the Command Line</a></span><span style="color: #196bff"> </span>topic. </div><p id="ww1022023" class="Body"><span></span>Register retiming can be either forward or backward. Forward retiming will move a set of registers that are the inputs of logic to a single register at its output. Backward retiming will move a register that is at the output of a logic to a set of registers at its input. Retiming works on data path, and has variable delay shift and variable area cost from design to design.</p><p id="ww1022024" class="Body"><span></span>One big positive factor about register retiming is that it will allow for more delay shift. On the negative side, it changes your netlist, making debugging more difficult. It also has a minimum delay shift of one logic level: for example, a LUT.</p><div class="ww_skin_page_overflow"><p id="ww1135763" class="Body"><span></span>Example: the original network<img class="Default" src="../../User%20Guides/Implementing%20the%20Design/images/design_imp_2.16.14.1.jpg" width="100%" style="display: block; left: 0.0pt; max-height: 103px; max-width: 520px; top: 0.0pt" alt="" title="" />&nbsp; </p></div><div class="ww_skin_page_overflow"><p id="ww1135768" class="Body"><span></span>retiming approach<img class="Default" src="../../User%20Guides/Implementing%20the%20Design/images/design_imp_2.16.14.2.jpg" width="100%" style="display: block; left: 0.0pt; max-height: 93px; max-width: 528px; top: 0.0pt" alt="" title="" />&nbsp; </p></div><div class="ww_skin_page_overflow"><p id="ww1135754" class="Body"><span></span>Clock Boosting approach<img class="Default" src="../../User%20Guides/Implementing%20the%20Design/images/design_imp_2.16.14.3.jpg" width="100%" style="display: block; left: 0.0pt; max-height: 167px; max-width: 532px; top: 0.0pt" alt="" title="" /></p></div><p id="ww1022036" class="Body"><span></span>For comparison, clock boosting (only applicable to LatticeSC) works on clock paths and has fixed delay (e.g., 0 ns, 1 ns, 2 ns, or 3 ns) and a fixed area cost (on silicon). The delay shift is accurate after Place &amp; Route (as fine as &lt;= 1ns). Unfortunately, clock boosting requires the use of extra silicon area even if it is not used, and delay shift is limited to few choices up to about 3ns or more. So, please take these considerations into account when you are trying to optimize timing in your design using either of these features. </p><div class="ww_skin_page_overflow"><table class="Note" cellspacing="0" summary=""><caption class="NoteTitle" style="caption-side: top"><div id="ww1063114" class="NoteTitle">Note</div></caption><tr><td style="background-color: White; border-bottom-color: #E5E5E5; border-bottom-style: none; border-bottom-width: 1px; border-left-style: none; border-right-color: #E5E5E5; border-right-style: none; border-right-width: 0px; border-top-color: #E5E5E5; border-top-style: none; border-top-width: 1.0pt; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 4px; vertical-align: top"><div id="ww1063116" class="CellBody"><span></span>Like clock boosting, register retiming, in most cases will improve your design's maximum frequency; however, improved timing is design-dependent and is not guaranteed in all cases. Circuits that have considerably unbalanced delay on two sides of a register will benefit the most from register retiming. Circuits that are already register-balanced may receive no benefit at all.</div></td></tr></table></div><h5 id="ww1022038" class="HeadingRunIn"><span></span>What Should You Retime? </h5><div id="ww1022039" class="Bulleted"><span class="WebWorks_Number" style="width: 16.56pt"><span><img src="../square.png" alt="*" border="0" width="7" height="7" /></span></span>In most cases, a register can be moved across a combinational logic component that has a known functionality, such as AND/OR gates, LUTs, etc.</div><div id="ww1091759" class="Bulleted"><span class="WebWorks_Number" style="width: 16.56pt"><span><img src="../square.png" alt="*" border="0" width="7" height="7" /></span></span>In most cases, registers are moved across one logic component at a time. Special architecture considerations will move registers across multiple levels of combinational logic components such as MUX5 (2 LUTs + 1 MUX2), carry chains, etc.</div><div class="ww_skin_page_overflow"><p id="ww1091763" class="Body"><span></span><img class="Default" src="../../User%20Guides/Implementing%20the%20Design/images/reg_retiming_2.jpg" width="100%" style="display: block; left: 0.0pt; max-height: 201px; max-width: 386px; top: 0.0pt" alt="" title="" /></p></div><h5 id="ww1091764" class="HeadingRunIn"><span></span>When Should You Retime? </h5><p id="ww1022046" class="Body"><span></span>This depends upon timing constraints (i.e., f<span style="vertical-align: sub">MAX</span>, t<span style="vertical-align: sub">SU</span>, and t<span style="vertical-align: sub">CO</span>). First compare the slack time on input (D) and output (Q) sides of the register and determine which direction to move.</p><p id="ww1022047" class="Body"><span></span>When to move registers forward: when the output port of a register (Q) is much more critical than its input port (D) and the projected worst slack is better. Forward retiming generally saves area; that is, it reduces register counts.</p><p id="ww1022048" class="Body"><span></span>Legal condition: all input registers must be “compatible”.</p><div class="ww_skin_page_overflow"><p id="ww1022052" class="Body"><span></span><img class="Default" src="../../User%20Guides/Implementing%20the%20Design/images/reg_forward1.jpg" width="100%" style="display: block; left: 0.0pt; max-height: 167px; max-width: 377px; top: 0.0pt" alt="" title="" /></p></div><p id="ww1022053" class="Body"><span></span>Reg1, 2, 3 must be compatible (i.e., have the same control signals).</p><div class="ww_skin_page_overflow"><p id="ww1022057" class="Body"><span></span><img class="Default" src="../../User%20Guides/Implementing%20the%20Design/images/reg_forward2.jpg" width="100%" style="display: block; left: 0.0pt; max-height: 158px; max-width: 381px; top: 0.0pt" alt="" title="" /></p></div><p id="ww1022058" class="Body"><span></span>When to move registers backward: when the input port of a register (D) is much more critical than its output port (Q) and the projected worst slack is better. The register needs to be replicated to all inputs of the combinational components it moves across.</p><h5 id="ww1022059" class="HeadingRunIn"><span></span>What are the Costs?</h5><p id="ww1091674" class="Body"><span></span>Area cost – The primary area cost is due to register replication in backward retiming. </p><div class="ww_skin_page_overflow"><p id="ww1091696" class="Body"><span></span>Example: Four registers are replicated<img class="Default" src="../../User%20Guides/Implementing%20the%20Design/images/reg_retiming_area_cost.jpg" width="100%" style="display: block; left: 0.0pt; max-height: 116px; max-width: 278px; top: 0.0pt" alt="" title="" /></p></div><p id="ww1091701" class="Body"><span></span>Although forward retiming reduces the number of registers, more than 70 percent of retiming happens in backward retiming. So overall, it results in an area cost. Is this an issue? Statistically, most designs have more than double the amount of LUTs than FFs, because many FFs in used PFUs are left unused. They can be used for retiming purposes. In implementation, we have soft-constrained a certain percentage of device resources to allow for FF replication.</p><p id="ww1074890" class="Body"><span></span>Run time cost – The main computation for retiming occurs in the timing engine. This will contribute to a longer run time in the flow. </p><h5 id="ww1074895" class="HeadingRunIn"><span></span>NORETIME Attribute </h5><p id="ww1022073" class="Body"><span></span>You can prevent retiming on an instance and its hierarchy with the NORETIME attribute. The NORETIME IO attribute will globally disallow retiming on I/O registers at the top level.</p><h5 id="ww1022074" class="HeadingRunIn"><span></span>Preference Support</h5><p id="ww1022075" class="Body"><span></span>Retiming supports six timing preferences. They are INPUT_SETUP, CLOCK_TO_OUT, FREQUENCY, MULTICYCLE, MAXDELAY, and PERIOD. Other preferences have no effect on retiming.</p><h5 id="ww1081685" class="HeadingRunIn"><span></span>See Also</h5><div id="ww1081687" class="Portal" style="vertical-align: baseline"><span class="WebWorks_Number" style="width: 16.56pt"><span><img src="../square.png" alt="*" border="0" width="7" height="7" /></span></span><span class="Hyperlink"><a href="../../User%20Guides/Implementing%20the%20Design/mapping_options.htm#ww1071510" title="Setting Map Design Options">Setting Map Design Options</a></span></div><div id="ww1135814" class="Portal" style="vertical-align: baseline"><span class="WebWorks_Number" style="width: 16.56pt"><span><img src="../square.png" alt="*" border="0" width="7" height="7" /></span></span><span style="color: #196bff; font-size: 10.0pt; font-style: normal; font-variant: normal; font-weight: normal; text-transform: none; vertical-align: baseline"><a href="../../Reference%20Guides/Constraints%20Ref/NORETIME.htm#ww1220156" title="NORETIME">NORETIME</a></span><span style="color: #196bff; font-size: 10.0pt; font-style: normal; font-variant: normal; font-weight: normal; text-transform: none; vertical-align: baseline"> (HDL Attribute)</span></div></div><div id="page_dates"><div class="ww_skin_page_publish_date"></div></div><!-- Related Topics --><!--                --><footer><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><br /></footer></div></div><noscript><div id="noscript_warning">This site works best with JavaScript enabled</div></noscript></body></html>